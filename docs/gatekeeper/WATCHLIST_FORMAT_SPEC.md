# ë¬¸ì§€ê¸°ë´‡(Gatekeeper Bot) ê³µì‹ ì¶œë ¥ í˜•ì‹ ëª…ì„¸

## ğŸ“‹ ê°œìš”

ë¬¸ì§€ê¸°ë´‡ì€ `prepare_tomorrow.py` ì‹¤í–‰ ì‹œ `watchlist_YYYYMMDD.json` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
ì´ íŒŒì¼ì€ ì •ì°°ë´‡ì´ ë‹¤ìŒ ê±°ë˜ì¼ì— ì‚¬ìš©í•  ì¢…ëª© ë¦¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.

**íŒŒì¼ ìœ„ì¹˜:** `scout_selector/output/watchlist_YYYYMMDD.json`

---

## ğŸ“„ JSON êµ¬ì¡°

### ìµœìƒìœ„ êµ¬ì¡°

```json
{
  "meta": { ... },
  "largecap": [ ... ],
  "volume": [ ... ],
  "structure": [ ... ],
  "theme": [ ... ]
}
```

---

## ğŸ”‘ ë©”íƒ€ ì •ë³´ (`meta`)

```json
{
  "meta": {
    "date": "20260108",                    // ë‚ ì§œ (YYYYMMDD)
    "created_at": "2026-01-07T15:35:00.123456",  // ìƒì„± ì¼ì‹œ (ISO 8601)
    "phase": "normal",                      // ì‹¤í–‰ ë‹¨ê³„ ("warmup" | "normal")
    "gatekeeper_version": "1.0.0",          // ë¬¸ì§€ê¸°ë´‡ ë²„ì „ (ëª…ì‹œì  í•„ë“œ)
    "gatekeeper_bot_version": "1.0.0"       // í˜¸í™˜ì„± ìœ ì§€ í•„ë“œ
  }
}
```

**í•„ë“œ ì„¤ëª…:**
- `date`: ë‚´ì¼ ë‚ ì§œ (YYYYMMDD í˜•ì‹)
- `created_at`: íŒŒì¼ ìƒì„± ì¼ì‹œ (ISO 8601 í˜•ì‹)
- `phase`: ì‹¤í–‰ ë‹¨ê³„
  - `"warmup"`: ë°ì´í„° ë¶€ì¡± ì‹œ (Cold Start)
  - `"normal"`: ì •ìƒ ì‹¤í–‰ ì‹œ
- `gatekeeper_version`: ë¬¸ì§€ê¸°ë´‡ ë²„ì „ (ì˜ˆ: "1.0.0")
- `gatekeeper_bot_version`: í˜¸í™˜ì„± ìœ ì§€ìš© (ë™ì¼ ê°’)

---

## ğŸ“Š ì¢…ëª© ì •ë³´ êµ¬ì¡°

ê° ì¹´í…Œê³ ë¦¬(`largecap`, `volume`, `structure`, `theme`)ëŠ” ì¢…ëª© ê°ì²´ ë°°ì—´ì…ë‹ˆë‹¤.

### ê³µí†µ í•„ë“œ

ëª¨ë“  ì¢…ëª© ê°ì²´ëŠ” ë‹¤ìŒ í•„ë“œë¥¼ í¬í•¨í•©ë‹ˆë‹¤:

```json
{
  "symbol": "035420",              // ì¢…ëª©ì½”ë“œ (6ìë¦¬)
  "category": "volume",            // ì¹´í…Œê³ ë¦¬ (ì¶œë ¥ ë©”íƒ€ í•„ë“œ)
  "bucket": "volume",              // í˜¸í™˜ì„± ìœ ì§€ í•„ë“œ (categoryì™€ ë™ì¼)
  "score": 0.85,                   // ì ìˆ˜ (0.0 ~ 1.0)
  "selection_reason": "...",       // ì„ ì • ì‚¬ìœ  ìš”ì•½ (ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” í˜•íƒœ)
  "reason": { ... },               // ìƒì„¸ ì„ ì • ì‚¬ìœ 
  "indicators": { ... }            // ì‚¬ìš©ëœ ì£¼ìš” ì§€í‘œ ê°’
}
```

---

## ğŸ¢ ëŒ€í˜•ì£¼ (`largecap`)

```json
{
  "symbol": "005930",
  "category": "largecap",
  "bucket": "largecap",
  "score": 1.0,
  "selection_reason": "ëŒ€í˜•ì£¼ ê³ ì • ì„ ì • (ì¢…ê°€: 75,000ì›, ê±°ë˜ëŒ€ê¸ˆ: 1,234,567,890ì›)",
  "reason": {
    "summary": "ëŒ€í˜•ì£¼ ê³ ì • ì„ ì • (ì¢…ê°€: 75,000ì›, ê±°ë˜ëŒ€ê¸ˆ: 1,234,567,890ì›)",
    "close": 75000.0,
    "turnover_krw": 1234567890.0
  },
  "indicators": {
    "close": 75000.0,
    "turnover_krw": 1234567890.0
  }
}
```

**íŠ¹ì§•:**
- ê³ ì • ì„ ì • (í•­ìƒ í¬í•¨)
- `score`: í•­ìƒ 1.0
- `indicators`: ì¢…ê°€, ê±°ë˜ëŒ€ê¸ˆ

---

## ğŸ“ˆ ê±°ë˜ëŸ‰í˜• (`volume`)

```json
{
  "symbol": "035420",
  "category": "volume",
  "bucket": "volume",
  "score": 0.85,
  "selection_reason": "ê±°ë˜ëŸ‰í˜• ì„ ì • (ê±°ë˜ëŒ€ê¸ˆ: 5,000,000,000ì›, ê±°ë˜ëŸ‰ ìŠ¤íŒŒì´í¬: 2.5ë°°, ë³€ë™ì„±: 4.2%)",
  "reason": {
    "summary": "ê±°ë˜ëŸ‰í˜• ì„ ì • (ê±°ë˜ëŒ€ê¸ˆ: 5,000,000,000ì›, ê±°ë˜ëŸ‰ ìŠ¤íŒŒì´í¬: 2.5ë°°, ë³€ë™ì„±: 4.2%)",
    "turnover_krw": 5000000000.0,
    "vol_spike_ratio": 2.5,
    "hlc_volatility": 0.042
  },
  "indicators": {
    "turnover_krw": 5000000000.0,
    "vol_spike_ratio": 2.5,
    "hlc_volatility": 0.042
  }
}
```

**íŠ¹ì§•:**
- ê±°ë˜ëŸ‰/ê±°ë˜ëŒ€ê¸ˆ ì§‘ì¤‘ ì¢…ëª©
- `indicators`: ê±°ë˜ëŒ€ê¸ˆ, ê±°ë˜ëŸ‰ ìŠ¤íŒŒì´í¬ ë¹„ìœ¨, ë³€ë™ì„±

---

## ğŸ—ï¸ êµ¬ì¡°í˜• (`structure`)

```json
{
  "symbol": "000270",
  "category": "structure",
  "bucket": "structure",
  "score": 0.75,
  "structure_score": 72.0,  // êµ¬ì¡° ì ìˆ˜ (0~100ì , êµ¬ì¡°í˜•ë§Œ)
  "selection_reason": "êµ¬ì¡°í˜• ì„ ì • (ì ìˆ˜: 72ì , MA ì •ë°°ì—´, MA ìƒí–¥ ëŒíŒŒ, Higher Low)",
  "reason": {
    "summary": "êµ¬ì¡°í˜• ì„ ì • (ì ìˆ˜: 72ì , MA ì •ë°°ì—´, MA ìƒí–¥ ëŒíŒŒ, Higher Low)",
    "structure_score": 72.0,
    "ma_aligned": true,
    "ma_breakout": true,
    "higher_low": true,
    "new_high": false
  },
  "indicators": {
    "structure_score": 72.0,
    "ma5": 45000.0,
    "ma20": 44000.0,
    "ma60": 43000.0,
    "close": 45500.0
  }
}
```

**íŠ¹ì§•:**
- ì¶”ì„¸Â·êµ¬ì¡° ë³€í™” ì¢…ëª©
- `structure_score`: êµ¬ì¡° ì ìˆ˜ (0~100ì ) - **êµ¬ì¡°í˜•ë§Œ í¬í•¨**
- `indicators`: êµ¬ì¡° ì ìˆ˜, ì´ë™í‰ê· ì„ (MA5/MA20/MA60), ì¢…ê°€

**êµ¬ì¡° ì ìˆ˜ êµ¬ì„±:**
- ì´ë™í‰ê·  êµ¬ì¡°: 35ì 
- ê·¸ëœë¹Œ ë²•ì¹™: 25ì  (ë³´ì¡° ìš”ì†Œ)
- ê³ ì Â·ì €ì  êµ¬ì¡°: 25ì 
- ì•ˆì •ì„± ë³´ì •: 15ì 

---

## ğŸ¯ í…Œë§ˆí˜• (`theme`)

```json
{
  "symbol": "005380",
  "category": "theme",
  "bucket": "theme",
  "score": 0.65,
  "selection_reason": "í…Œë§ˆí˜• ì„ ì • (í…Œë§ˆ ì ìˆ˜: 1.00, ê±°ë˜ëŒ€ê¸ˆ: 3,000,000,000ì›, ì¶œì²˜: condition:AI_ê´€ë ¨ì£¼, news:AI,ê²€ìƒ‰)",
  "reason": {
    "summary": "í…Œë§ˆí˜• ì„ ì • (í…Œë§ˆ ì ìˆ˜: 1.00, ê±°ë˜ëŒ€ê¸ˆ: 3,000,000,000ì›, ì¶œì²˜: condition:AI_ê´€ë ¨ì£¼, news:AI,ê²€ìƒ‰)",
    "theme_score": 1.0,
    "turnover_krw": 3000000000.0,
    "sources": [
      "condition:AI_ê´€ë ¨ì£¼",
      "news:AI,ê²€ìƒ‰"
    ]
  },
  "indicators": {
    "theme_score": 1.0,
    "turnover_krw": 3000000000.0,
    "sources": [
      "condition:AI_ê´€ë ¨ì£¼",
      "news:AI,ê²€ìƒ‰"
    ]
  }
}
```

**íŠ¹ì§•:**
- ë™ì¼ í…Œë§ˆ/ë‰´ìŠ¤/ì„¹í„° ë™ì¡° ì¢…ëª©
- `indicators`: í…Œë§ˆ ì ìˆ˜, ê±°ë˜ëŒ€ê¸ˆ, ì¶œì²˜(sources)

**ì¶œì²˜ í˜•ì‹:**
- ì¡°ê±´ì‹: `"condition:{ì¡°ê±´ì‹_ì´ë¦„}"`
- ë‰´ìŠ¤: `"news:{í‚¤ì›Œë“œ1},{í‚¤ì›Œë“œ2}"`

---

## ğŸ“‹ í•„ë“œ ìš”ì•½

### í•„ìˆ˜ ë©”íƒ€ í•„ë“œ

| í•„ë“œ | ìœ„ì¹˜ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|
| `gatekeeper_version` | `meta` | ë¬¸ì§€ê¸°ë´‡ ë²„ì „ | `"1.0.0"` |
| `category` | ê° ì¢…ëª© | ì¹´í…Œê³ ë¦¬ | `"largecap"`, `"volume"`, `"structure"`, `"theme"` |
| `selection_reason` | ê° ì¢…ëª© | ì„ ì • ì‚¬ìœ  ìš”ì•½ | `"êµ¬ì¡°í˜• ì„ ì • (ì ìˆ˜: 72ì , ...)"` |
| `structure_score` | êµ¬ì¡°í˜•ë§Œ | êµ¬ì¡° ì ìˆ˜ (0~100ì ) | `72.0` |
| `indicators` | ê° ì¢…ëª© | ì£¼ìš” ì§€í‘œ ê°’ | `{ "ma5": 45000.0, ... }` |

### í˜¸í™˜ì„± ìœ ì§€ í•„ë“œ

| í•„ë“œ | ì„¤ëª… |
|------|------|
| `gatekeeper_bot_version` | `gatekeeper_version`ê³¼ ë™ì¼ (í˜¸í™˜ì„± ìœ ì§€) |
| `bucket` | `category`ì™€ ë™ì¼ (í˜¸í™˜ì„± ìœ ì§€) |
| `reason` | ìƒì„¸ ì„ ì • ì‚¬ìœ  (ê¸°ì¡´ í˜•ì‹ í˜¸í™˜) |

---

## ğŸ”„ ì •ì°°ë´‡ ì—°ë™

ì •ì°°ë´‡ì€ ë‹¤ìŒ ìˆœì„œë¡œ íŒŒì¼ì„ ì½ìŠµë‹ˆë‹¤:

1. **ìš°ì„ ìˆœìœ„**: `watchlist_{ë‚´ì¼ë‚ ì§œ}.json` (ì˜ˆ: `watchlist_20260108.json`)
2. **Fallback**: `latest_watchlist.json` (ìµœì‹  íŒŒì¼)

**ê¶Œì¥ ì‚¬í•­:**
- `prepare_tomorrow.py` ì‹¤í–‰ í›„ ìƒì„±ëœ `watchlist_YYYYMMDD.json`ì„ ì‚¬ìš©
- í•„ìš” ì‹œ `latest_watchlist.json`ì„ ì‹¬ë³¼ë¦­ ë§í¬ ë˜ëŠ” ë³µì‚¬ë³¸ìœ¼ë¡œ ê´€ë¦¬

---

## ğŸ“ ì˜ˆì‹œ íŒŒì¼

ì „ì²´ ì˜ˆì‹œëŠ” `WATCHLIST_FORMAT_EXAMPLE.json` íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.







